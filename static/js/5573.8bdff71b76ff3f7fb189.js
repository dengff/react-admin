"use strict";(self.webpackChunkantd_admin=self.webpackChunkantd_admin||[]).push([[5573],{45573:($e,M,t)=>{t.r(M),t.d(M,{default:()=>ge});var Se=t(66992),Ie=t(33948),Ke=t(88674),k=t(4942),q=t(29439),O=t(44925),L=t(74165),p=t(15861),o=t(1413),_=t(49101),ee=t(97462),ne=t(952),te=t(47510),ae=t(26369),z=t(22270),le=t(48171),re=t(60249),D=t(71577),oe=t(33845),ie=t(21770),de=t(88306),H=t(8880),f=t(67294),ue=t(45618),i=t(85893),ve=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],ce=["record","position","creatorButtonText","newRecordType","parentKey","style"],W=f.createContext(void 0);function G(e){var m=e.children,R=e.record,y=e.position,x=e.newRecordType,h=e.parentKey,g=(0,f.useContext)(W);return f.cloneElement(m,(0,o.Z)((0,o.Z)({},m.props),{},{onClick:function(){var C=(0,p.Z)((0,L.Z)().mark(function I(K){var E,$,T,V;return(0,L.Z)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(E=($=m.props).onClick)===null||E===void 0?void 0:E.call($,K);case 2:if(V=s.sent,V!==!1){s.next=5;break}return s.abrupt("return");case 5:g==null||(T=g.current)===null||T===void 0||T.addEditRecord(R,{position:y,newRecordType:x,parentKey:h});case 6:case"end":return s.stop()}},I)}));function b(I){return C.apply(this,arguments)}return b}()}))}function J(e){var m,R,y=(0,te.YB)(),x=e.onTableChange,h=e.maxLength,g=e.formItemProps,C=e.recordCreatorProps,b=e.rowKey,I=e.controlled,K=e.defaultValue,E=e.onChange,$=e.editableFormRef,T=(0,O.Z)(e,ve),V=(0,ae.D)(e.value),S=(0,f.useRef)(),s=(0,f.useRef)();(0,f.useImperativeHandle)(T.actionRef,function(){return S.current});var ye=(0,ie.Z)(function(){return e.value||K||[]},{value:e.value,onChange:e.onChange}),Q=(0,q.Z)(ye,2),d=Q[0],xe=Q[1],j=f.useMemo(function(){return typeof b=="function"?b:function(v,n){return v[b]||n}},[b]),U=function(n){if(typeof n=="number"&&!e.name){if(n>=d.length)return n;var a=d&&d[n];return j?.(a,n)}if((typeof n=="string"||n>=d.length)&&e.name){var l=d.findIndex(function(r,u){var c;return(j==null||(c=j(r,u))===null||c===void 0?void 0:c.toString())===n?.toString()});return l}return n};(0,f.useImperativeHandle)($,function(){var v=function(l){var r,u;if(l==null)throw new Error("rowIndex is required");var c=U(l),Z=[e.name,(r=c?.toString())!==null&&r!==void 0?r:""].flat(1).filter(Boolean);return(u=s.current)===null||u===void 0?void 0:u.getFieldValue(Z)},n=function(){var l,r=[e.name].flat(1).filter(Boolean);if(Array.isArray(r)&&r.length===0){var u,c=(u=s.current)===null||u===void 0?void 0:u.getFieldsValue();return Array.isArray(c)?c:Object.keys(c).map(function(Z){return c[Z]})}return(l=s.current)===null||l===void 0?void 0:l.getFieldValue(r)};return(0,o.Z)((0,o.Z)({},s.current),{},{getRowData:v,getRowsData:n,setRowData:function(l,r){var u,c,Z,A;if(l==null)throw new Error("rowIndex is required");var N=U(l),Fe=[e.name,(u=N?.toString())!==null&&u!==void 0?u:""].flat(1).filter(Boolean),De=((c=s.current)===null||c===void 0||(Z=c.getFieldsValue)===null||Z===void 0?void 0:Z.call(c))||{},Ee=(0,H.Z)(De,Fe,(0,o.Z)((0,o.Z)({},v(l)),r||{}));return(A=s.current)===null||A===void 0||A.setFieldsValue(Ee),!0}})}),(0,f.useEffect)(function(){e.controlled&&d.forEach(function(v,n){var a;(a=s.current)===null||a===void 0||a.setFieldsValue((0,k.Z)({},j(v,n),v))},{})},[d,e.controlled]),(0,f.useEffect)(function(){if(e.name){var v;s.current=e==null||(v=e.editable)===null||v===void 0?void 0:v.form}},[(m=e.editable)===null||m===void 0?void 0:m.form,e.name]);var P=C||{},Ze=P.record,w=P.position,Re=P.creatorButtonText,Ce=P.newRecordType,be=P.parentKey,Te=P.style,Ve=(0,O.Z)(P,ce),X=w==="top",F=(0,f.useMemo)(function(){return typeof h=="number"&&h<=d?.length?!1:C!==!1&&(0,i.jsx)(G,{record:(0,z.h)(Ze,d?.length,d)||{},position:w,parentKey:(0,z.h)(be,d?.length,d),newRecordType:Ce,children:(0,i.jsx)(D.ZP,(0,o.Z)((0,o.Z)({type:"dashed",style:(0,o.Z)({display:"block",margin:"10px 0",width:"100%"},Te),icon:(0,i.jsx)(_.Z,{})},Ve),{},{children:Re||y.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[C,h,d?.length]),je=(0,f.useMemo)(function(){return F?X?{components:{header:{wrapper:function(n){var a,l=n.className,r=n.children;return(0,i.jsxs)("thead",{className:l,children:[r,(0,i.jsxs)("tr",{style:{position:"relative"},children:[(0,i.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:F}),(0,i.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(a=T.columns)===null||a===void 0?void 0:a.length,children:F})]})]})}}}}:{tableViewRender:function(n,a){var l,r;return(0,i.jsxs)(i.Fragment,{children:[(l=(r=e.tableViewRender)===null||r===void 0?void 0:r.call(e,n,a))!==null&&l!==void 0?l:a,F]})}}:{}},[X,F]),B=(0,o.Z)({},e.editable),Pe=(0,le.J)(function(v,n){var a,l,r;if((a=e.editable)===null||a===void 0||(l=a.onValuesChange)===null||l===void 0||l.call(a,v,n),(r=e.onValuesChange)===null||r===void 0||r.call(e,n,v),e.controlled){var u;e==null||(u=e.onChange)===null||u===void 0||u.call(e,n)}});return(e!=null&&e.onValuesChange||(R=e.editable)!==null&&R!==void 0&&R.onValuesChange||e.controlled&&e!==null&&e!==void 0&&e.onChange)&&(B.onValuesChange=Pe),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(W.Provider,{value:S,children:(0,i.jsx)(ue.Z,(0,o.Z)((0,o.Z)((0,o.Z)({search:!1,options:!1,pagination:!1,rowKey:b,revalidateOnFocus:!1},T),je),{},{tableLayout:"fixed",actionRef:S,onChange:x,editable:(0,o.Z)((0,o.Z)({},B),{},{formProps:(0,o.Z)({formRef:s},B.formProps)}),dataSource:d,onDataSourceChange:function(n){if(xe(n),e.name&&w==="top"){var a,l=(0,H.Z)({},[e.name].flat(1).filter(Boolean),n);(a=s.current)===null||a===void 0||a.setFieldsValue(l)}}}))}),e.name?(0,i.jsx)(ee.Z,{name:[e.name],children:function(n){var a,l,r=(0,de.Z)(n,[e.name].flat(1)),u=r?.find(function(c,Z){return!(0,re.A)(c,V?.[Z])});return u&&V&&(e==null||(a=e.editable)===null||a===void 0||(l=a.onValuesChange)===null||l===void 0||l.call(a,u,r)),null}}):null]})}function Y(e){var m=ne.ZP.useFormInstance();return e.name?(0,i.jsx)(oe.Z.Item,(0,o.Z)((0,o.Z)({style:{maxWidth:"100%"}},e?.formItemProps),{},{name:e.name,children:(0,i.jsx)(J,(0,o.Z)((0,o.Z)({},e),{},{editable:(0,o.Z)((0,o.Z)({},e.editable),{},{form:m})}))})):(0,i.jsx)(J,(0,o.Z)({},e))}Y.RecordCreator=G;const se=Y;var fe=t(84466),me=t(99165);const he=[{factory:"3",index:0,key:1679556413535,materialNumber:"s",period:"1",remark:"\u662F\u662F\u662F",time:"2023-03-06"}],ge=()=>{const[e,m]=(0,f.useState)(he),R=[{title:"\u7269\u6599\u53F7",valueType:"text",dataIndex:"materialNumber"},{title:"\u671F\u6570",dataIndex:"period",valueEnum:{1:{text:"\u7B2C\u4E00\u671F"},2:{text:"\u7B2C\u4E8C\u671F"},3:{text:"\u7B2C\u4E09\u671F"},4:{text:"\u7B2C\u56DB\u671F"}}},{title:"\u65F6\u95F4",dataIndex:"time",valueType:"date"},{title:"\u5DE5\u5382",dataIndex:"factory",valueType:"select",valueEnum:{1:{text:"\u76AE\u9769\u5382"},2:{text:"\u6A61\u80F6\u5382"},3:{text:"\u5236\u9769\u5382"}}},{title:"\u5907\u6CE8",dataIndex:"remark"},{title:"\u64CD\u4F5C",valueType:"option",render:(y,x,h,g)=>[(0,i.jsx)("a",{onClick:()=>{g?.startEditable(x.key)},children:"\u7F16\u8F91"},"edit"),(0,i.jsx)(D.ZP,{type:"text",size:"small",icon:(0,i.jsx)(me.Z,{}),onClick:()=>{g?.addEditRecord({...x,key:Date.now()})},children:"\u590D\u5236"},"copy"),(0,i.jsx)(D.ZP,{type:"text",size:"small",danger:!0,onClick:()=>{m(e.filter(C=>x.key!==C.key))},children:"\u5220\u9664"},"delete")]}];return(0,i.jsx)(se,{columns:R,rowKey:"key",headerTitle:"\u7F16\u8F91Table",editable:{type:"multiple",actionRender:(y,x,h)=>(console.log(h,x,"dom"),[h.save,h.cancel])},value:e,onChange:y=>{console.log(y,"value"),m(y)},recordCreatorProps:{record:()=>({key:Date.now()})},toolBarRender:()=>[(0,i.jsx)(D.ZP,{type:"primary",disabled:!e.length,onClick:()=>new Promise((y,x)=>{setTimeout(h=>{y(e),fe.ZP.success("\u63D0\u4EA4\u6210\u529F")},1500)}),children:"\u63D0\u4EA4"})]})}}}]);
