"use strict";(self.webpackChunkantd_admin=self.webpackChunkantd_admin||[]).push([[4770],{41937:(yn,je,o)=>{o.d(je,{W:()=>pe,X:()=>ce});var H=o(29439),De=o(21770),de=o(80334),M=o(67294),Q=o(39614),se=o(85893);function r(){var k,W,N,p,l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},V=(0,M.useRef)(),Ve=(0,M.useRef)(null),q=(0,M.useRef)(),be=(0,M.useRef)(),$e=(0,M.useState)(""),ee=(0,H.Z)($e,2),v=ee[0],ne=ee[1],ve=(0,M.useRef)([]),Xe=(0,De.Z)(function(){return l.size||l.defaultSize||"middle"},{value:l.size,onChange:l.onSizeChange}),Ke=(0,H.Z)(Xe,2),fe=Ke[0],Ye=Ke[1],te=(0,M.useMemo)(function(){var f,s;if(l!=null&&(f=l.columnsState)!==null&&f!==void 0&&f.defaultValue)return l.columnsState.defaultValue;var R={};return(s=l.columns)===null||s===void 0||s.forEach(function(h,b){var n=h.key,e=h.dataIndex,O=h.fixed,$=h.disable,y=(0,Q.II)(n??e,b);y&&(R[y]={show:!0,fixed:O,disable:$})}),R},[l.columns]),F=(0,De.Z)(function(){var f,s,R=l.columnsState||{},h=R.persistenceType,b=R.persistenceKey;if(b&&h&&typeof window<"u"){var n=window[h];try{var e=n?.getItem(b);if(e)return JSON.parse(e)}catch(O){console.warn(O)}}return l.columnsStateMap||((f=l.columnsState)===null||f===void 0?void 0:f.value)||((s=l.columnsState)===null||s===void 0?void 0:s.defaultValue)||te},{value:((k=l.columnsState)===null||k===void 0?void 0:k.value)||l.columnsStateMap,onChange:((W=l.columnsState)===null||W===void 0?void 0:W.onChange)||l.onColumnsStateChange}),Oe=(0,H.Z)(F,2),me=Oe[0],S=Oe[1];(0,M.useEffect)(function(){var f=l.columnsState||{},s=f.persistenceType,R=f.persistenceKey;if(R&&s&&typeof window<"u"){var h=window[s];try{var b=h?.getItem(R);S(b?JSON.parse(b):te)}catch(n){console.warn(n)}}},[l.columnsState,te,S]),(0,de.ET)(!l.columnsStateMap,"columnsStateMap\u5DF2\u7ECF\u5E9F\u5F03\uFF0C\u8BF7\u4F7F\u7528 columnsState.value \u66FF\u6362"),(0,de.ET)(!l.columnsStateMap,"columnsStateMap has been discarded, please use columnSstate.value replacement");var Te=(0,M.useCallback)(function(){var f=l.columnsState||{},s=f.persistenceType,R=f.persistenceKey;if(!(!R||!s||typeof window>"u")){var h=window[s];try{h?.removeItem(R)}catch(b){console.warn(b)}}},[l.columnsState]);(0,M.useEffect)(function(){var f,s;if(!(!((f=l.columnsState)!==null&&f!==void 0&&f.persistenceKey)||!((s=l.columnsState)!==null&&s!==void 0&&s.persistenceType))&&!(typeof window>"u")){var R=l.columnsState,h=R.persistenceType,b=R.persistenceKey,n=window[h];try{n?.setItem(b,JSON.stringify(me))}catch(e){console.warn(e),Te()}}},[(N=l.columnsState)===null||N===void 0?void 0:N.persistenceKey,me,(p=l.columnsState)===null||p===void 0?void 0:p.persistenceType]);var ae={action:V.current,setAction:function(s){V.current=s},sortKeyColumns:ve.current,setSortKeyColumns:function(s){ve.current=s},propsRef:be,columnsMap:me,keyWords:v,setKeyWords:function(s){return ne(s)},setTableSize:Ye,tableSize:fe,prefixName:q.current,setPrefixName:function(s){q.current=s},setColumnsMap:S,columns:l.columns,rootDomRef:Ve,clearPersistenceStorage:Te,defaultColumnKeyMap:te};return Object.defineProperty(ae,"prefixName",{get:function(){return q.current}}),Object.defineProperty(ae,"sortKeyColumns",{get:function(){return ve.current}}),Object.defineProperty(ae,"action",{get:function(){return V.current}}),ae}var ce=(0,M.createContext)({}),pe=function(W){var N=r(W.initValue);return(0,se.jsx)(ce.Provider,{value:N,children:W.children})}},14770:(yn,je,o)=>{o.d(je,{Z:()=>b});var H=o(74165),De=o(15861),de=o(71002),M=o(29439),Q=o(4942),se=o(93433),r=o(1413),ce=o(44925),pe=o(84517),k=o(952),W=o(59852),N=o(86671),p=o(51812),l=o(21770),V=o(27068),Ve=o(78164),q=o(99149),be=o(58331),$e=o(94184),ee=o.n($e),v=o(67294),ne=o(30939),ve=o(25101),Xe=o(90695),Ke=o(43299),fe=o(41937),Ye=o(95055),te=o(51164),F=o(39614),Oe=o(28083),me=o(52248),S=o(85893),Te=["rowKey","tableClassName","defaultClassName","action","tableColumn","type","pagination","rowSelection","size","defaultSize","tableStyle","toolbarDom","searchNode","style","cardProps","alertDom","name","onSortChange","onFilterChange","options","isLightFilter","className","cardBordered","editableUtils","getRowKey"],ae=["cardBordered","request","className","params","defaultData","headerTitle","postData","ghost","pagination","actionRef","columns","toolBarRender","onLoad","onRequestError","style","cardProps","tableStyle","tableClassName","columnsStateMap","onColumnsStateChange","options","search","name","onLoadingChange","rowSelection","beforeSearchSubmit","tableAlertRender","defaultClassName","formRef","type","columnEmptyText","toolbar","rowKey","manualRequest","polling","tooltip","revalidateOnFocus"];function f(n){var e=n.rowKey,O=n.tableClassName,$=n.defaultClassName,y=n.action,Ze=n.tableColumn,_e=n.type,_=n.pagination,oe=n.rowSelection,Ie=n.size,on=n.defaultSize,Je=n.tableStyle,u=n.toolbarDom,Se=n.searchNode,Ae=n.style,x=n.cardProps,z=n.alertDom,rn=n.name,Be=n.onSortChange,ln=n.onFilterChange,ge=n.options,un=n.isLightFilter,Ge=n.className,dn=n.cardBordered,Le=n.editableUtils,U=n.getRowKey,T=(0,ce.Z)(n,Te),re=(0,v.useContext)(fe.X),X=(0,v.useMemo)(function(){var C=function D(K){return K.map(function(d){var P=(0,F.II)(d.key,d.index),Z=re.columnsMap[P];return Z&&Z.show===!1?!1:d.children?(0,r.Z)((0,r.Z)({},d),{},{children:D(d.children)}):d}).filter(Boolean)};return C(Ze)},[re.columnsMap,Ze]),We=(0,v.useMemo)(function(){return X?.every(function(C){return C.filters===!0&&C.onFilter===!0||C.filters===void 0&&C.onFilter===void 0})},[X]),g=function(D){var K=Le.newLineRecord||{},d=K.options,P=K.defaultValue;if(d!=null&&d.parentKey){var Z,w,ie={data:D,getRowKey:U,row:(0,r.Z)((0,r.Z)({},P),{},{map_row_parentKey:(Z=(0,N.sN)(d?.parentKey))===null||Z===void 0?void 0:Z.toString()}),key:d?.recordKey,childrenColumnName:((w=n.expandable)===null||w===void 0?void 0:w.childrenColumnName)||"children"};return(0,N.cx)(ie,d.position==="top"?"top":"update")}if(d?.position==="top")return[P].concat((0,se.Z)(y.dataSource));if(_&&_!==null&&_!==void 0&&_.current&&_!==null&&_!==void 0&&_.pageSize){var I=(0,se.Z)(y.dataSource);return _?.pageSize>I.length?(I.push(P),I):(I.splice(_?.current*_?.pageSize-1,0,P),I)}return[].concat((0,se.Z)(y.dataSource),[P])},Ne=function(){return(0,r.Z)((0,r.Z)({},T),{},{size:Ie,rowSelection:oe===!1?void 0:oe,className:O,style:Je,columns:X.map(function(D){return D.isExtraColumns?D.extraColumn:D}),loading:y.loading,dataSource:Le.newLineRecord?g(y.dataSource):y.dataSource,pagination:_,onChange:function(K,d,P,Z){var w;if((w=T.onChange)===null||w===void 0||w.call(T,K,d,P,Z),We||ln((0,p.Y)(d)),Array.isArray(P)){var ie=P.reduce(function(j,Ue){return(0,r.Z)((0,r.Z)({},j),{},(0,Q.Z)({},"".concat(Ue.field),Ue.order))},{});Be((0,p.Y)(ie))}else{var I,J=(I=P.column)===null||I===void 0?void 0:I.sorter,He=J?.toString()===J;Be((0,p.Y)((0,Q.Z)({},"".concat(He?J:P.field),P.order))||{})}}})},Ce=(0,v.useMemo)(function(){return n.search===!1&&!n.headerTitle&&n.toolBarRender===!1},[]),he=(0,S.jsx)(q.Z,(0,r.Z)((0,r.Z)({},Ne()),{},{rowKey:e})),le=n.tableViewRender?n.tableViewRender((0,r.Z)((0,r.Z)({},Ne()),{},{rowSelection:oe!==!1?oe:void 0}),he):he,ye=(0,v.useMemo)(function(){if(n.editable&&!n.name){var C,D,K,d;return(0,S.jsxs)(S.Fragment,{children:[u,z,(0,v.createElement)(k.ZP,(0,r.Z)((0,r.Z)({},(C=n.editable)===null||C===void 0?void 0:C.formProps),{},{formRef:(D=n.editable)===null||D===void 0||(K=D.formProps)===null||K===void 0?void 0:K.formRef,component:!1,form:(d=n.editable)===null||d===void 0?void 0:d.form,onValuesChange:Le.onValuesChange,key:"table",submitter:!1,omitNil:!1,dateFormatter:n.dateFormatter}),le)]})}return(0,S.jsxs)(S.Fragment,{children:[u,z,le]})},[z,n.loading,!!n.editable,le,u]),Y=(0,v.useMemo)(function(){return x===!1||Ce===!0||n.name?{}:u?{paddingBlockStart:0}:u&&_===!1?{paddingBlockStart:0}:u?{}:{padding:0}},[Ce,_,n.name,x,u]),Ee=x===!1||Ce===!0||n.name?ye:(0,S.jsx)(pe.ZP,(0,r.Z)((0,r.Z)({ghost:n.ghost,bordered:(0,F.DU)("table",dn),bodyStyle:Y},x),{},{children:ye})),xe=function(){return n.tableRender?n.tableRender(n,Ee,{toolbar:u||void 0,alert:z||void 0,table:le||void 0}):Ee},Pe=(0,S.jsxs)("div",{className:ee()(Ge,(0,Q.Z)({},"".concat($,"-polling"),y.pollingLoading)),style:Ae,ref:re.rootDomRef,children:[un?null:Se,_e!=="form"&&n.tableExtraRender&&(0,S.jsx)("div",{className:ee()(Ge,"".concat($,"-extra")),children:n.tableExtraRender(n,y.dataSource||[])}),_e!=="form"&&xe()]});return!ge||!(ge!=null&&ge.fullScreen)?Pe:(0,S.jsx)(be.ZP,{getPopupContainer:function(){return re.rootDomRef.current||document.body},children:Pe})}var s={},R=function(e){var O,$=e.cardBordered,y=e.request,Ze=e.className,_e=e.params,_=_e===void 0?s:_e,oe=e.defaultData,Ie=e.headerTitle,on=e.postData,Je=e.ghost,u=e.pagination,Se=e.actionRef,Ae=e.columns,x=Ae===void 0?[]:Ae,z=e.toolBarRender,rn=e.onLoad,Be=e.onRequestError,ln=e.style,ge=e.cardProps,un=e.tableStyle,Ge=e.tableClassName,dn=e.columnsStateMap,Le=e.onColumnsStateChange,U=e.options,T=e.search,re=e.name,X=e.onLoadingChange,We=e.rowSelection,g=We===void 0?!1:We,Ne=e.beforeSearchSubmit,Ce=e.tableAlertRender,he=e.defaultClassName,le=e.formRef,ye=e.type,Y=ye===void 0?"table":ye,Ee=e.columnEmptyText,xe=Ee===void 0?"-":Ee,Pe=e.toolbar,C=e.rowKey,D=e.manualRequest,K=e.polling,d=e.tooltip,P=e.revalidateOnFocus,Z=P===void 0?!1:P,w=(0,ce.Z)(e,ae),ie=(0,Ye.X)(e.defaultClassName),I=ie.wrapSSR,J=ie.hashId,He=ee()(he,Ze,J),j=(0,v.useRef)(),Ue=(0,v.useRef)(),we=le||Ue;(0,v.useImperativeHandle)(Se,function(){return j.current});var En=(0,l.Z)(g?g?.defaultSelectedRowKeys||[]:void 0,{value:g?g.selectedRowKeys:void 0}),sn=(0,M.Z)(En,2),G=sn[0],Qe=sn[1],Pn=(0,l.Z)(function(){if(!(D||T!==!1))return{}}),cn=(0,M.Z)(Pn,2),Me=cn[0],Fe=cn[1],Mn=(0,l.Z)({}),vn=(0,M.Z)(Mn,2),ke=vn[0],qe=vn[1],Rn=(0,l.Z)({}),fn=(0,M.Z)(Rn,2),en=fn[0],nn=fn[1];(0,v.useEffect)(function(){var t=(0,F._f)(x),a=t.sort,i=t.filter;qe(i),nn(a)},[]);var mn=(0,W.YB)(),Dn=(0,de.Z)(u)==="object"?u:{defaultCurrent:1,defaultPageSize:20,pageSize:20,current:1},E=(0,v.useContext)(fe.X),_n=(0,v.useMemo)(function(){if(y)return function(){var t=(0,De.Z)((0,H.Z)().mark(function a(i){var c,A;return(0,H.Z)().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return c=(0,r.Z)((0,r.Z)((0,r.Z)({},i||{}),Me),_),delete c._timestamp,B.next=4,y(c,en,ke);case 4:return A=B.sent,B.abrupt("return",A);case 6:case"end":return B.stop()}},a)}));return function(a){return t.apply(this,arguments)}}()},[Me,_,ke,en,y]),m=(0,te.Z)(_n,oe,{pageInfo:u===!1?!1:Dn,loading:e.loading,dataSource:e.dataSource,onDataSourceChange:e.onDataSourceChange,onLoad:rn,onLoadingChange:X,onRequestError:Be,postData:on,revalidateOnFocus:Z,manual:Me===void 0,polling:K,effects:[(0,ne.P)(_),(0,ne.P)(Me),(0,ne.P)(ke),(0,ne.P)(en)],debounceTime:e.debounceTime,onPageInfoChange:function(a){var i,c;Y==="list"||!u||!_n||(u==null||(i=u.onChange)===null||i===void 0||i.call(u,a.current,a.pageSize),u==null||(c=u.onShowSizeChange)===null||c===void 0||c.call(u,a.current,a.pageSize))}});(0,v.useEffect)(function(){var t;if(!(e.manualRequest||!e.request||!Z||(t=e.form)!==null&&t!==void 0&&t.ignoreRules)){var a=function(){document.visibilityState==="visible"&&m.reload()};return document.addEventListener("visibilitychange",a),function(){return document.removeEventListener("visibilitychange",a)}}},[]);var Sn=v.useRef(new Map),ze=v.useMemo(function(){return typeof C=="function"?C:function(t,a){var i;return a===-1?t?.[C]:e.name?a?.toString():(i=t?.[C])!==null&&i!==void 0?i:a?.toString()}},[e.name,C]);(0,v.useMemo)(function(){var t;if((t=m.dataSource)!==null&&t!==void 0&&t.length){var a=m.dataSource.map(function(i){var c=ze(i,-1);return Sn.current.set(c,i),c});return a}return[]},[m.dataSource,ze]);var gn=(0,v.useMemo)(function(){var t=u===!1?!1:(0,r.Z)({},u),a=(0,r.Z)((0,r.Z)({},m.pageInfo),{},{setPageInfo:function(c){var A=c.pageSize,L=c.current,B=m.pageInfo;if(A===B.pageSize||B.current===1){m.setPageInfo({pageSize:A,current:L});return}y&&m.setDataSource([]),m.setPageInfo({pageSize:A,current:Y==="list"?L:1})}});return y&&t&&(delete t.onChange,delete t.onShowSizeChange),(0,F.qL)(t,a,mn)},[u,m,mn]);(0,V.KW)(function(){var t;e.request&&_&&m.dataSource&&(m==null||(t=m.pageInfo)===null||t===void 0?void 0:t.current)!==1&&m.setPageInfo({current:1})},[_]),E.setPrefixName(e.name);var tn=(0,v.useCallback)(function(){g&&g.onChange&&g.onChange([],[],{type:"none"}),Qe([])},[g,Qe]);E.setAction(j.current),E.propsRef.current=e;var Re=(0,N.CB)((0,r.Z)((0,r.Z)({},e.editable),{},{tableName:e.name,getRowKey:ze,childrenColumnName:((O=e.expandable)===null||O===void 0?void 0:O.childrenColumnName)||"children",dataSource:m.dataSource||[],setDataSource:function(a){var i,c;(i=e.editable)===null||i===void 0||(c=i.onValuesChange)===null||c===void 0||c.call(i,void 0,a),m.setDataSource(a)}}));(0,F.tx)(j,m,{fullScreen:function(){var a;if(!(!((a=E.rootDomRef)!==null&&a!==void 0&&a.current)||!document.fullscreenEnabled))if(document.fullscreenElement)document.exitFullscreen();else{var i;(i=E.rootDomRef)===null||i===void 0||i.current.requestFullscreen()}},onCleanSelected:function(){tn()},resetAll:function(){var a;tn(),qe({}),nn({}),E.setKeyWords(void 0),m.setPageInfo({current:1}),we==null||(a=we.current)===null||a===void 0||a.resetFields(),Fe({})},editableUtils:Re}),Se&&(Se.current=j.current);var ue=(0,v.useMemo)(function(){var t;return(0,me.A)({columns:x,counter:E,columnEmptyText:xe,type:Y,editableUtils:Re,rowKey:C,childrenColumnName:(t=e.expandable)===null||t===void 0?void 0:t.childrenColumnName}).sort((0,Oe.u)(E.columnsMap))},[x,E?.sortKeyColumns,E?.columnsMap,xe,Y,Re.editableKeys&&Re.editableKeys.join(",")]);(0,V.Au)(function(){if(ue&&ue.length>0){var t=ue.map(function(a){return(0,F.II)(a.key,a.index)});E.setSortKeyColumns(t)}},[ue],["render","renderFormItem"],100),(0,V.KW)(function(){var t=m.pageInfo,a=u||{},i=a.current,c=i===void 0?t?.current:i,A=a.pageSize,L=A===void 0?t?.pageSize:A;u&&(c||L)&&(L!==t?.pageSize||c!==t?.current)&&m.setPageInfo({pageSize:L||t.pageSize,current:c||t.current})},[u&&u.pageSize,u&&u.current]);var bn=(0,r.Z)((0,r.Z)({selectedRowKeys:G},g),{},{onChange:function(a,i,c){g&&g.onChange&&g.onChange(a,i,c),Qe(a)}}),an=T!==!1&&T?.filterType==="light",Kn=function(a){if(U&&U.search){var i,c,A=U.search===!0?{}:U.search,L=A.name,B=L===void 0?"keyword":L,In=(i=U.search)===null||i===void 0||(c=i.onSearch)===null||c===void 0?void 0:c.call(i,E.keyWords);if(In!==!1){Fe((0,r.Z)((0,r.Z)({},a),{},(0,Q.Z)({},B,E.keyWords)));return}}Fe(a)},On=(0,v.useMemo)(function(){if((0,de.Z)(m.loading)==="object"){var t;return((t=m.loading)===null||t===void 0?void 0:t.spinning)||!1}return m.loading},[m.loading]),Cn=T===!1&&Y!=="form"?null:(0,S.jsx)(Xe.Z,{pagination:gn,beforeSearchSubmit:Ne,action:j,columns:x,onFormSearchSubmit:function(a){Kn(a)},ghost:Je,onReset:e.onReset,onSubmit:e.onSubmit,loading:!!On,manualRequest:D,search:T,form:e.form,formRef:we,type:e.type||"table",cardBordered:e.cardBordered,dateFormatter:e.dateFormatter}),hn=(0,v.useMemo)(function(){return G?.map(function(t){var a;return(a=Sn.current)===null||a===void 0?void 0:a.get(t)})},[G]),Tn=z===!1?null:(0,S.jsx)(Ke.Z,{headerTitle:Ie,hideToolbar:U===!1&&!Ie&&!z&&!Pe&&!an,selectedRows:hn,selectedRowKeys:G,tableColumn:ue,tooltip:d,toolbar:Pe,onFormSearchSubmit:function(a){Fe((0,r.Z)((0,r.Z)({},Me),a))},searchNode:an?Cn:null,options:U,actionRef:j,toolBarRender:z}),Zn=g!==!1?(0,S.jsx)(ve.Z,{selectedRowKeys:G,selectedRows:hn,onCleanSelected:tn,alertOptionRender:w.tableAlertOptionRender,alertInfoRender:Ce,alwaysShowAlert:g?.alwaysShowAlert}):null;return I((0,S.jsx)(f,(0,r.Z)((0,r.Z)({},e),{},{name:re,defaultClassName:he,size:E.tableSize,onSizeChange:E.setTableSize,pagination:gn,searchNode:Cn,rowSelection:g!==!1?bn:void 0,className:He,tableColumn:ue,isLightFilter:an,action:m,alertDom:Zn,toolbarDom:Tn,onSortChange:nn,onFilterChange:qe,editableUtils:Re,getRowKey:ze})))},h=function(e){var O=(0,v.useContext)(be.ZP.ConfigContext),$=O.getPrefixCls,y=e.ErrorBoundary===!1?v.Fragment:e.ErrorBoundary||Ve.S;return(0,S.jsx)(fe.W,{initValue:e,children:(0,S.jsx)(W._Y,{needDeps:!0,children:(0,S.jsx)(y,{children:(0,S.jsx)(R,(0,r.Z)({defaultClassName:"".concat($("pro-table"))},e))})})})};h.Summary=q.Z.Summary;const b=h}}]);
